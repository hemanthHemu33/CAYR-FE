"use strict"; var QCGridConfigration = function (t) { this._qcGrid = t, this.gridAPI = "", this.gridSaveAPI = "", this._qcGridContainerID = this._qcGrid.containerID, this.AddGridConfigrationIcon(t) }; function IntOnly(t) { parseInt(t.key) || "Backspace" == t.key || "0" == t.key || t.preventDefault() } QCGridConfigration.prototype = { maxIntValue: 2147483647, AddGridConfigrationIcon: function (t) { var e = this; t.AddGridConfigrationIcon = function () { var t = this.containerID, i = t + "_QCGridConfigrationIocn", a = '<a href="#" id="' + i + '" class="in-grid-pgbtn-xs" data-ev="EV_TKT_GRIDCONFIG" title="Configure grid" ><i class="fas fa-cog" data-ev="EV_TKT_GRIDCONFIG"></i></a>'; $("#" + (t + "_QCGridPager") + " > div").prepend(a), document.getElementById(i).addEventListener("click", e) } }, _getGridConfiguration: function (t, e) { var i = this, a = {}, n = this.gridAPI; a.GridName = this._qcGridContainerID, __DoAsyncPostBack(a, n, (function (a) { i._loadGridConfiguration(a, t, e) })) }, _showGridConfiguration: function () { $("#gridConfig_" + this._qcGridContainerID).modal(), $("#gridConfig_" + this._qcGridContainerID).show(), $("#gridConfig_" + this._qcGridContainerID).addClass("show") }, _hideGridConfiguration: function () { $("#gridConfig_" + this._qcGridContainerID).hide() }, _loadGridConfiguration: function (t, e, i) { if (0 != t.Success) { var a = t.Sender, n = "gridConfig_" + this._qcGridContainerID, s = document.getElementById(n); null != s && null != s && $("#" + n).remove(), (s = document.createElement("div")).id = n, s.setAttribute("class", "modal fade"), s.setAttribute("role", "dialog"), s.setAttribute("data-evl", "EVL_GRID_CONGIG"); var r = this._gridConfigurationHtml(t.ResultData); if (s.innerHTML = r, document.body.appendChild(s), s.addEventListener("click", this), "0" == a) { var d = "#tblGridConfig_" + this._qcGridContainerID; $(d).find("input[type=checkbox][name='Grid_RowSelect']").prop("checked", !0), $(d).find("input[type=checkbox][name='grid_selectAll']").prop("checked", !0), this._stageDataForCommit(!0) } this._showGridConfiguration(), 1 == e && $("#errMsg_" + this._qcGridContainerID).html(i) } }, _gridConfigurationHtml: function (t) { var e = ""; e += '<div class="modal-dialog modal-dialog-scrollable" style="margin-left:16rem;">', e += '\t<div class="modal-content" style="width:60rem;">', e += '\t\t<div class="modal-header" style="padding: 10px 30px;">', e += '\t\t\t<h1 class="modal-title fs-5" style="font-weight:bold;">' + this._qcGridContainerID + " Grid Configration</h1>", e += '            <div class="error-message mx-5" id="errMsg_' + this._qcGridContainerID + '">', e += "\t\t\t</div>", e += '\t\t\t<button type="button" class="btn-close" data-ev="EV_CLOSE_GRID_CONFIG" aria-label="Close" title="Close"></button>', e += "\t\t</div>", e += '\t\t<div class="modal-body" style="padding:0px 20px;max-height: calc(100vh - 250px);">', e += '\t\t\t<div class="col-md-12 col-lg-12">', e += '\t\t\t\t<div class="form-group" style="margin-bottom: 10px;">', e += '                    <table id="tblGridConfig_' + this._qcGridContainerID + '" cellpadding="0" cellspacing="0" class="table table-bordered table-striped table-hover">', e += '                    \t<thead data-evl="EVL_GRID_CONGIG_HEAD">', e += '                    \t\t<tr class="table-primary">', e += '                    \t\t\t<th hidden style="width: 5px;">ID</th>', e += '                    \t\t\t<th style="width: 5px;text-align: center;"><input type="checkbox" name="grid_selectAll" data-ev="EV_GRID_CONGIG_SELECTALL_CHK"></th>', e += '                    \t\t\t<th style="width: 295px;">Display</th>', e += '                    \t\t\t<th style="width: 3px;">Width</th>', e += '                    \t\t\t<th style="width: 3px;">Sortable</th>', e += '                    \t\t\t<th style="width: 3px;">Hidden</th>', e += '                    \t\t\t<th style="width: 3px;">Order</th>', e += '                    \t\t\t<th hidden style="width: 5px;">Name</th>', e += "                    \t\t</tr>", e += "                    \t</thead>", e += '                    \t<tbody data-evl="EVL_GRID_CONGIG_BODY">'; for (var i = 0; i < t.length; i++)1 == t[i].IsUser ? e += '                    \t<tr data-ev-data="" class="table-success">' : e += '                    \t<tr data-ev-data="" class="table-noclass">', e += "                    \t\t\t<td hidden>" + t[i].ID + "</td>", 1 == t[i].IsUser ? e += '                    \t\t\t<td style="text-align: center;"><input type="checkbox" name="Grid_RowSelect" data-ev="EV_GRID_CONGIG_SELECTED_CHK" class="form-check-input selectChk" style="margin-left:1px" checked></td>' : e += '                    \t\t\t<td style="text-align: center;"><input type="checkbox" name="Grid_RowSelect" data-ev="EV_GRID_CONGIG_SELECT_CHK" class="form-check-input selectChk" style="margin-left:1px"></td>', e += '                    \t\t\t<td><input type="text" name="Grid_Display" class="input-sm txt" style="width:100%" maxlength="50" value="' + t[i].Display + '"></td>', e += '                    \t\t\t<td><input type="text" name="Grid_Width" class="input-sm txt" style="width:100%" onkeypress="IntOnly(event)" onpaste="IntOnly(event)" value="' + t[i].Width + '"></td>', 1 == t[i].SortableFlag ? e += '                    \t\t\t<td style="text-align: center;"><input type="checkbox" class="form-check-input" name="Grid_SortableFlag" style="margin-left:1px" checked></td>' : e += '                    \t\t\t<td style="text-align: center;"><input type="checkbox"  class="form-check-input" name="Grid_SortableFlag" style="margin-left:1px"></td>', 1 == t[i].HideFlag ? e += '                    \t\t\t<td style="text-align: center;"><input type="checkbox" class="form-check-input" name="Grid_HideFlag" style="margin-left:1px" checked></td>' : e += '                    \t\t\t<td style="text-align: center;"><input type="checkbox"  class="form-check-input" name="Grid_HideFlag" style="margin-left:1px"></td>', e += '                    \t\t\t<td><input type="number" name="Grid_ColumnOrder" class="input-sm txt" style="width:100%" maxlength="2" value="' + t[i].ColumnOrder + '"></td>', e += "                    \t\t\t<td hidden>" + t[i].Name + "</td>", e += "                    \t\t</tr>"; return e += "                    \t</tbody>", e += "                    </table>", e += "\t\t\t\t</div>", e += "\t\t\t</div>", e += "\t\t</div>", e += '        <div class="modal-footer">', e += this._getSaveButton(), e += "\t</div>", e += "\t</div>", e += "</div>" }, _getSaveButton: function () { return '<button class="btn btn-sm btn-outline-success btn-fw mx-3" data-ev="EV_GRID_CONFIG_SAVE">', '\t<i class="fas fa-save mr-1" data-ev="EV_GRID_CONFIG_SAVE"></i> Save', "</button>", '<button class="btn btn-sm btn-outline-success btn-fw mx-3" data-ev="EV_GRID_CONFIG_SAVE">\t<i class="fas fa-save mr-1" data-ev="EV_GRID_CONFIG_SAVE"></i> Save</button>' }, _gridCongifCheckBoxChecked: function (t) { t.checked ? $(t).closest("tr").hasClass("table-danger") && ($(t).closest("tr").removeClass("table-danger"), $(t).closest("tr").addClass("table-success")) : $(t).closest("tr").hasClass("table-success") && ($(t).closest("tr").removeClass("table-sucess"), $(t).closest("tr").addClass("table-danger")) }, _gridCongifCheckBoxUnChecked: function (t) { t.checked ? $(t).closest("tr").hasClass("table-noclass") && ($(t).closest("tr").removeClass("table-noclass"), $(t).closest("tr").addClass("table-warning")) : $(t).closest("tr").hasClass("table-warning") && ($(t).closest("tr").removeClass("table-warning"), $(t).closest("tr").addClass("table-noclass")) }, _saveGridConfiguration: function () { var t, e = "#tblGridConfig_" + this._qcGridContainerID; if ($(e + " tbody .table-noclass").length != $(e + " tbody tr").length) if ($("#errMsg_" + this._qcGridContainerID).html(""), 0 != (t = this._getGridConfigTableData(e)).CVAGridConfigurationMeta.length) { var i = this.gridSaveAPI, a = this; __DoAsyncPostBack(t, i, (function (t) { if (1 == t.Success) return a._hideGridConfiguration(), a._qcGrid.clearBind(), void a._qcGrid.onSubmit(a._qcGrid.gridData.param); $("#errMsg_" + a._qcGridContainerID).html("Error in configuration saveing") })) } else $("#errMsg_" + this._qcGridContainerID).html("Please select row(s) you would like to add to your grid configuration"); else $("#errMsg_" + this._qcGridContainerID).html("Please select row(s) you would like to add to your grid configuration") }, _getGridConfigTableData: function (t) { for (var e = [], i = $(t + " tbody tr").length, a = 0; a < i; a++) { var n = $($(t + " tbody tr")[a].cells[1]).find("input[type=checkbox][name='Grid_RowSelect']").is(":checked"); if (0 != n && 1 == n) { var s = {}; if (s.ID = $($(t + " tbody tr")[a].cells[0])[0].innerHTML, s.Display = $($(t + " tbody tr")[a].cells[2]).find("input[type=text][name='Grid_Display']").val(), s.Width = $($(t + " tbody tr")[a].cells[3]).find("input[type=text][name='Grid_Width']").val(), parseInt(s.Width) > this.maxIntValue) return void $("#errMsg_" + this._qcGridContainerID).html(s.Display + " width can not be more then " + this.maxIntValue); n = $($(t + " tbody tr")[a].cells[4]).find("input[type=checkbox][name='Grid_SortableFlag']").is(":checked"), s.SortableFlag = 0, 1 == n && (s.SortableFlag = 1), n = $($(t + " tbody tr")[a].cells[5]).find("input[type=checkbox][name='Grid_HideFlag']").is(":checked"), s.HideFlag = 0, 1 == n && (s.HideFlag = 1), s.ColumnOrder = $($(t + " tbody tr")[a].cells[6]).find("input[type=number][name='Grid_ColumnOrder']").val(), s.Name = $($(t + " tbody tr")[a].cells[7])[0].innerHTML, e.push(s) } } var r = {}; return r.GridName = this._qcGridContainerID, r.CVAGridConfigurationMeta = e, r }, _gridConfigSelectAll: function (t) { var e = "#tblGridConfig_" + this._qcGridContainerID; $(e).find("input[type=checkbox][name='Grid_RowSelect']").prop("checked", t.checked), $(".selectChk").prop("checked", t.checked), this._stageDataForCommit(t.checked) }, _stageDataForCommit: function (t) { t ? $(".selectChk").closest("tr").hasClass("table-noclass") && ($(".selectChk").closest("tr").removeClass("table-noclass"), $(".selectChk").closest("tr").addClass("table-warning")) : $(".selectChk").closest("tr").hasClass("table-warning") && ($(".selectChk").closest("tr").removeClass("table-warning"), $(".selectChk").closest("tr").addClass("table-noclass")) }, handleEvent: function (t) { switch (t.target.getAttribute("data-ev")) { case "EV_CLOSE_GRID_CONFIG": this._hideGridConfiguration(); break; case "EV_GRID_CONFIG_SAVE": $("#errMsg_" + this._qcGridContainerID).html(""), this._saveGridConfiguration(); break; case "EV_GRID_CONGIG_SELECTED_CHK": $("#errMsg_" + this._qcGridContainerID).html(""), this._gridCongifCheckBoxChecked(t.target); break; case "EV_GRID_CONGIG_SELECT_CHK": $("#errMsg_" + this._qcGridContainerID).html(""), this._gridCongifCheckBoxUnChecked(t.target); break; case "EV_GRID_CONGIG_SELECTALL_CHK": $("#errMsg_" + this._qcGridContainerID).html(""), this._gridConfigSelectAll(t.target); break; case "EV_TKT_GRIDCONFIG": t.stopPropagation(), this._getGridConfiguration() } } };