function AjaxInput() { return { command: "", sender: "", message: "", InputData: {}, KeyValueData: [] } } function AjaxOutput() { return { command: "", commandArgs: [], message: "", resultData: [], sender: "", success: "" } } function __DoAsyncPostBackWebMethod(s, n, e) { $.ajax({ type: "POST", url: n, data: JSON.stringify(s), contentType: "application/json; charset=utf-8", dataType: "json", error: function (s, n, e) { asyncPostbackError(s, n, e) }, beforeSend: function () { showAsyncProgress() }, complete: function () { hideAsyncProgress() }, success: function (s, n) { "success" == n && e(s.d) } }) } function __DoAsyncPostBack(s, n, e) { $.ajax({ type: "POST", url: n, data: JSON.stringify(s), contentType: "application/json; charset=utf-8", dataType: "json", error: function (s, n, e) { asyncPostbackError(s, n, e) }, beforeSend: function () { showAsyncProgress() }, complete: function () { hideAsyncProgress() }, success: function (s, n) { if ("success" == n) { var o = null != s.d ? s.d : s; null == e.Callback ? e(o) : e.Callback(o) } } }) } function __PromisAsyncPostBack(s, n) { return new Promise((function (e, o) { $.ajax({ type: "POST", url: n, data: JSON.stringify(s), contentType: "application/json; charset=utf-8", dataType: "json", error: function (s, n, e) { o(e), asyncPostbackError(s, n, e) }, beforeSend: function () { showAsyncProgress() }, complete: function () { hideAsyncProgress() }, success: function (s, n) { if ("success" == n) { var c = null != s.d ? s.d : s; e(c) } else o(n) } }) })) } function asyncPostbackError(s, n, e, o) { switch (console.log("xhr :" + s.status), s.status) { case 0: case 404: case 500: break; case 403: case 401: console.log(s.responseJSON.payload), location.href = s.responseJSON.payload }console.log("errStatus :" + n + ":" + s.responseText) } function showAsyncProgress() { $("#AsyncRequestProgress").show() } function hideAsyncProgress() { $("#AsyncRequestProgress").hide() }